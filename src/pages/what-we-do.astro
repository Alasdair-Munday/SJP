---
import Layout from "../layouts/Layout.astro";
import { ArrowRight } from "lucide-react";
import { getSiteContent } from "../data/site-content";

const content = await getSiteContent();
const page = content.pages.ministries;
const give = content.pages.give;
type MinistryGroup = (typeof page.groups)[number] & {
	intro?: string;
	image?: { src: string; alt: string };
};
const belong =
	(page.groups.find((group) => group.id === "belong") ??
		page.groups[0]) as MinistryGroup;
const serve =
	(page.groups.find((group) => group.id === "serve") ??
		page.groups[0]) as MinistryGroup;
const belongIntro =
	belong.intro ??
	"Belong by coming on Sundays and joining a midweek group.";
const belongImage = belong.image ?? {
	src: "/images/congregation.jpg",
	alt: "Church family and neighbours gathering together in the church grounds",
};
const serveIntro =
	serve.intro ??
	"Serve by joining a team or connecting with our local outreach ministries.";
const serveImage = serve.image ?? {
	src: "/images/lunch club.jpg",
	alt: "Community fun day games on the church field",
};
const giveImage = give.section_image ?? {
	src: "/images/PXL_20250816_114550760.PORTRAIT.jpg",
	alt: "Worship team leading sung praise during a Sunday gathering",
};
---

<Layout title={page.title}>
	<div class="max-w-7xl mx-auto px-4 py-20 space-y-10">
		<div class="space-y-4">
			<h1
				class="page-heading page-heading--accent text-5xl md:text-6xl font-bold"
			>
				{page.title}
			</h1>
			<p class="text-xl text-(--ink)/85 max-w-4xl">{page.intro}</p>
			<div class="flex flex-wrap gap-3">
				<a href="#belong" class="mission-chip mission-chip--belong"
					>{belong.heading}</a
				>
				<a href="#serve" class="mission-chip mission-chip--serve"
					>{serve.heading}</a
				>
				<a href="#give" class="mission-chip mission-chip--give">{give.title}</a>
			</div>
		</div>

		<section
			id="belong"
			class="sketch-panel theme-belong bg-(--eden-soft)/35 p-6 md:p-8 space-y-6 scroll-mt-28"
		>
			<div class="theme-drench theme-drench--eden p-5 space-y-2">
				<h2 class="section-heading text-4xl">{belong.heading}</h2>
				<p class="text-(--ink)/85 mt-2 max-w-3xl">
					{belongIntro}
				</p>
			</div>
			<figure class="theme-card overflow-hidden">
				<img
					src={belongImage.src}
					alt={belongImage.alt}
					class="w-full h-64 object-cover"
					loading="lazy"
				/>
			</figure>

			<div class="grid md:grid-cols-3 gap-4">
				{
					belong.items.map((item) => (
						<article class="theme-card theme-card--interactive p-5 flex flex-col gap-4">
							<h3 class="section-heading text-2xl">
								{item.title}
							</h3>
							<p class="text-(--ink)/85 grow">
								{item.description}
							</p>
							<a
								href={item.href}
								class="inline-flex items-center gap-2 font-semibold text-(--ink) hover:text-(--teal) transition-colors"
							>
								{item.link_label}
								<ArrowRight size={16} />
							</a>
						</article>
					))
				}
			</div>

			{
				belong.cta && (
					<div class="theme-drench theme-drench--eden p-6 md:p-8 flex flex-col md:flex-row md:items-center gap-6 justify-between">
						<div class="space-y-2">
							<h3 class="section-heading text-2xl">
								{belong.cta.text}
							</h3>
							<p class="text-(--ink)/85 text-lg max-w-xl">
								{belong.cta.description}
							</p>
						</div>
						<a
							href={belong.cta.href}
							class="inline-flex items-center justify-center gap-2 px-6 py-3 bg-(--ink) text-white border-2 border-(--ink) font-semibold hover:bg-white hover:text-(--ink) transition-colors whitespace-nowrap"
						>
							{belong.cta.text}
							<ArrowRight size={18} />
						</a>
					</div>
				)
			}
		</section>

		<section
			id="serve"
			class="sketch-panel theme-serve bg-(--teal-soft)/35 p-6 md:p-8 space-y-6 scroll-mt-28"
		>
			<div class="theme-drench theme-drench--teal p-5 space-y-2">
				<h2 class="section-heading text-4xl">{serve.heading}</h2>
				<p class="text-(--ink)/85 mt-2 max-w-3xl">
					{serveIntro}
				</p>
			</div>
			<figure class="theme-card overflow-hidden">
				<img
					src={serveImage.src}
					alt={serveImage.alt}
					class="w-full h-64 object-cover top-10"
					loading="lazy"
				/>
			</figure>

			<div class="grid md:grid-cols-3 gap-4">
				{
					serve.items.map((item) => (
						<article class="theme-card theme-card--interactive p-5 flex flex-col gap-4">
							<h3 class="section-heading text-2xl">
								{item.title}
							</h3>
							<p class="text-(--ink)/85 grow">
								{item.description}
							</p>
							<a
								href={item.href}
								class="inline-flex items-center gap-2 font-semibold text-(--ink) hover:text-(--teal) transition-colors"
							>
								{item.link_label}
								<ArrowRight size={16} />
							</a>
						</article>
					))
				}
			</div>
		</section>

		<section
			id="give"
			class="sketch-panel theme-give bg-(--gold-soft)/45 p-6 md:p-8 space-y-6 scroll-mt-28"
		>
			<div class="theme-drench theme-drench--gold p-5 space-y-2">
				<h2 class="section-heading text-4xl">{give.title}</h2>
				<p class="text-(--ink)/90 text-lg">
					{give.generosity_paragraph}
				</p>
			</div>
			<figure class="theme-card overflow-hidden">
				<img
					src={giveImage.src}
					alt={giveImage.alt}
					class="w-full h-64 object-cover"
					loading="lazy"
				/>
			</figure>

			<a
				href={give.online_giving.link}
				target="_blank"
				rel="noopener noreferrer"
				class="inline-flex items-center gap-2 px-6 py-3 bg-(--ink) text-white border-2 border-(--ink) hover:bg-white hover:text-(--ink) transition-colors font-semibold"
			>
				{give.online_giving.button_label}
			</a>

			<div class="grid lg:grid-cols-2 gap-4">
				<article class="theme-card p-6">
					<p class="font-semibold text-(--ink) mb-3">
						{give.methods_heading}
					</p>
					<ol class="list-decimal pl-6 space-y-2 text-(--ink)/90">
						{give.methods.map((method) => <li>{method}</li>)}
					</ol>
				</article>
				<article class="theme-card p-6 space-y-2">
					<h3 class="section-heading text-2xl">
						{give.bank_details.heading}
					</h3>
					{
						give.bank_details.lines.map((line) => (
							<p class="text-(--ink)/90">{line}</p>
						))
					}
					<p
						class="pt-2 text-(--ink)/90"
						set:html={give.contact_html}
					/>
				</article>
			</div>
		</section>
	</div>
</Layout>
