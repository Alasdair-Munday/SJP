---
import Layout from "../layouts/Layout.astro";
import { getSiteContent } from "../data/site-content";
import { Play, Calendar, User, BookOpen } from "lucide-react";
import dayjs from "dayjs";

const content = await getSiteContent();
const page = content.pages.sermons;
const sermons = content.sermons;
---

<Layout title={page.title}>
	<div class="max-w-7xl mx-auto px-4 py-20">
		<div class="flex items-end gap-4 mb-6 border-b-2 border-(--ink) pb-4">
			<h1 class="theme-display-font text-5xl md:text-6xl font-bold text-(--ink)">
				{page.title}
			</h1>
		</div>

		<p class="text-xl text-(--ink)/90 mb-3">
			{page.intro_primary}
		</p>
		<p class="text-(--ink)/80 mb-12">
			{page.intro_secondary}
		</p>

		<div class="grid gap-8">
			{
				sermons.map((sermon) => (
					<div class="bg-white border-2 border-(--ink) p-6 shadow-[4px_4px_0px_0px_var(--paper-line)] transition-all group">
						<div class="flex flex-col md:flex-row gap-6 items-start">
							<div class="bg-(--ink) text-(--gold) w-16 h-16 flex items-center justify-center shrink-0">
								<Play size={32} fill="currentColor" />
							</div>
							<div class="grow">
								<h2 class="text-3xl font-bold text-(--ink) mb-2">
									{sermon.title}
								</h2>
								<div class="flex flex-wrap gap-4 text-sm font-semibold text-(--ink)/70 mb-4 tracking-wide">
									<div class="flex items-center gap-2">
										<User size={16} /> {sermon.speaker}
									</div>
									<div class="flex items-center gap-2">
										<Calendar size={16} /> {dayjs(sermon.date).format("MMM D, YYYY")}
									</div>
									<div class="flex items-center gap-2">
										<BookOpen size={16} /> {sermon.passage}
									</div>
								</div>
								<p class="text-lg font-medium text-(--ink)/90 mb-6 max-w-2xl">
									{sermon.description}
								</p>

								{sermon.audioUrl ? (
									<audio controls class="w-full">
										<source src={sermon.audioUrl} type="audio/mpeg" />
										Your browser does not support the audio element.
									</audio>
								) : (
									<p class="font-semibold text-(--ink)/80">
										{page.audio_coming_soon}
									</p>
								)}
							</div>
						</div>
					</div>
				))
			}
		</div>

		<div class="mt-12 text-center">
			<a
				href="/rss.xml"
				class="inline-flex items-center gap-2 font-semibold tracking-wide bg-(--ink) text-white px-6 py-3 border-2 border-(--ink) hover:bg-white hover:text-(--ink) transition-colors"
			>
				{page.rss_button_label}
			</a>
		</div>
	</div>
</Layout>
