---
import Layout from "../layouts/Layout.astro";
import { getSiteContent } from "../data/site-content";
import { Play, Calendar, User, BookOpen } from "lucide-react";
import dayjs from "dayjs";

const content = await getSiteContent();
const page = content.pages.sermons;
const sermons = content.sermons;
const heroImage = page.hero_image ?? {
	src: "/images/Sermons.jpg",
	alt: "Woman speaking from the front during a Sunday talk",
};
---

<Layout title={page.title}>
	<div class="max-w-7xl mx-auto px-4 py-20">
		<div class="flex items-end gap-4 mb-6 border-b-2 border-(--ink) pb-4">
			<h1 class="page-heading page-heading--accent text-5xl md:text-6xl">
				{page.title}
			</h1>
		</div>

		<section class="space-y-8 mb-12">
			<div class="theme-drench theme-drench--gold p-6 md:p-8">
				<p class="text-xl text-(--ink)/90 mb-3 font-medium">
					{page.intro_primary}
				</p>
				<p class="text-lg text-(--ink)/80">
					{page.intro_secondary}
				</p>
			</div>
			<div class="theme-card overflow-hidden h-64 md:h-80">
				<img
					src={heroImage.src}
					alt={heroImage.alt}
					class="w-full h-full object-cover"
					loading="lazy"
				/>
			</div>
		</section>

		<div class="grid gap-8">
			{
				sermons.map((sermon) => (
					<div class="theme-card theme-card--interactive p-6 group">
						<div class="flex flex-col md:flex-row gap-6 items-start">
							<div class="bg-(--ink) text-(--gold) w-16 h-16 flex items-center justify-center shrink-0">
								<Play size={32} fill="currentColor" />
							</div>
							<div class="grow">
								<h2 class="section-heading text-3xl mb-2">
									{sermon.title}
								</h2>
								<div class="flex flex-wrap gap-4 text-sm font-semibold text-(--ink)/70 mb-4 tracking-wide">
									<div class="flex items-center gap-2">
										<User size={16} /> {sermon.speaker}
									</div>
									<div class="flex items-center gap-2">
										<Calendar size={16} />{" "}
										{dayjs(sermon.date).format(
											"MMM D, YYYY",
										)}
									</div>
									<div class="flex items-center gap-2">
										<BookOpen size={16} /> {sermon.passage}
									</div>
								</div>
								<p class="text-lg font-medium text-(--ink)/90 mb-6 max-w-2xl">
									{sermon.description}
								</p>

								{sermon.audioUrl ? (
									<audio controls class="w-full">
										<source
											src={sermon.audioUrl}
											type="audio/mpeg"
										/>
										Your browser does not support the audio
										element.
									</audio>
								) : (
									<p class="font-semibold text-(--ink)/80">
										{page.audio_coming_soon}
									</p>
								)}
							</div>
						</div>
					</div>
				))
			}
		</div>

		<div class="mt-12 text-center">
			<a
				href="/rss.xml"
				class="inline-flex items-center gap-2 font-semibold tracking-wide bg-(--ink) text-white px-6 py-3 border-2 border-(--ink) hover:bg-white hover:text-(--ink) transition-colors"
			>
				{page.rss_button_label}
			</a>
		</div>
	</div>
</Layout>
